<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'/>
  <script async src="https://cdn.datacamp.com/dcl-react-dev.js.gz"></script>
</head>

<body>
<div data-datacamp-exercise data-lang="r" data-show-run-button data-height="400">
  <code data-type="pre-exercise-code">
  	# This will get executed each time the exercise gets initialized
	  load(url("https://github.com/AaronGullickson/combined_stats/blob/master/example_datasets/add_health/popularity.RData?raw=true"))
	  library(ggplot2)
  </code>
  <code data-type="sample-code">
	# Create a barplot showing the distribution of smoking behavior conditional on race in the popularity dataset
	ggplot(popularity, aes())
  
  
  </code>
  <code data-type="solution">
# Create a barplot showing the distribution of smoking behavior conditional on race in the popularity dataset
  ggplot(popularity, 
         aes(x=smoker, 
             y=..prop.., 
             group=1))+
    geom_bar()+
    facet_wrap(~race)+
    labs(x="smoking behavior", 
         y="proportion")+
    theme_bw()
  </code>
  <code data-type="sct">
  ex() %>% {
    check_function(., "ggplot") %>% check_arg("data") %>% check_equal()
    check_function(., "aes") %>% {
      check_arg(., "x") %>% check_equal(eval=FALSE, 
                                        incorrect_msg="The `x` aesthetic should be the variable `smoker`.") 
      check_arg(., "y") %>% check_equal(eval=FALSE,
                                        incorrect_msg="The `y` aesthetic should be `..prop..`` for proportions.")
      check_arg(., "group") %>% check_equal(eval=FALSE, 
                                            incorrect_msg="In order for the proportions to sum to one, the `group` aesthetic must be `1`.")
  }
  check_function(., "geom_bar")
  check_function(., "facet_wrap") %>% check_arg(., "facets") %>% check_equal(eval=FALSE)
  check_function(., "labs", 
                 not_called_msg="You should provide labels for your axes with the `labs` command." ) %>% {
    check_arg(., "x", arg_not_specified_msg="You should label the x-axis")
    check_arg(., "y", arg_not_specified_msg="You should label the y-axis")
    }
  }
  success_msg("Great Job!")
</div>
</body>
</html>