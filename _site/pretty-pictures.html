<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Pretty Pictures | Statistical Analysis in Sociology</title>
  <meta name="description" content="Pretty Pictures | Statistical Analysis in Sociology, an entry level textbook for practical statistics in R" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Pretty Pictures | Statistical Analysis in Sociology" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://stat-analysis.netlify.app/" />
  
  <meta property="og:description" content="Pretty Pictures | Statistical Analysis in Sociology, an entry level textbook for practical statistics in R" />
  <meta name="github-repo" content="AaronGullickson/combined_stats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Pretty Pictures | Statistical Analysis in Sociology" />
  
  <meta name="twitter:description" content="Pretty Pictures | Statistical Analysis in Sociology, an entry level textbook for practical statistics in R" />
  

<meta name="author" content="Aaron Gullickson" />


<meta name="date" content="2020-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="object-types.html"/>
<link rel="next" href="using-git.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="my_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="understanding-data.html"><a href="understanding-data.html"><i class="fa fa-check"></i>Understanding Data</a><ul>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html"><i class="fa fa-check"></i>What Does Data Look Like?</a><ul>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html#the-observations"><i class="fa fa-check"></i>The observations</a></li>
<li class="chapter" data-level="" data-path="what-does-data-look-like.html"><a href="what-does-data-look-like.html#the-variables"><i class="fa fa-check"></i>The variables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html"><i class="fa fa-check"></i>What Can We Do With Data?</a><ul>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#how-is-a-variable-distributed"><i class="fa fa-check"></i>How is a variable distributed?</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#measuring-association"><i class="fa fa-check"></i>Measuring association</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#making-statistical-inferences"><i class="fa fa-check"></i>Making statistical inferences</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#building-models"><i class="fa fa-check"></i>Building Models</a></li>
<li class="chapter" data-level="" data-path="what-can-we-do-with-data.html"><a href="what-can-we-do-with-data.html#observational-data-experimental-thinking"><i class="fa fa-check"></i>Observational Data, Experimental Thinking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-distribution-of-a-variable.html"><a href="the-distribution-of-a-variable.html"><i class="fa fa-check"></i>The Distribution of a Variable</a><ul>
<li class="chapter" data-level="" data-path="looking-at-distributions.html"><a href="looking-at-distributions.html"><i class="fa fa-check"></i>Looking at Distributions</a><ul>
<li class="chapter" data-level="" data-path="looking-at-distributions.html"><a href="looking-at-distributions.html#looking-at-the-distribution-of-a-categorical-variable"><i class="fa fa-check"></i>Looking at the distribution of a categorical variable</a></li>
<li class="chapter" data-level="" data-path="looking-at-distributions.html"><a href="looking-at-distributions.html#looking-at-the-distribution-of-a-quantitative-variable"><i class="fa fa-check"></i>Looking at the distribution of a quantitative variable</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html"><i class="fa fa-check"></i>Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-mean"><i class="fa fa-check"></i>The mean</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-median"><i class="fa fa-check"></i>The median</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#the-mode"><i class="fa fa-check"></i>The mode</a></li>
<li class="chapter" data-level="" data-path="measuring-the-center-of-a-distribution.html"><a href="measuring-the-center-of-a-distribution.html#comparing-the-mean-and-median"><i class="fa fa-check"></i>Comparing the mean and median</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html"><i class="fa fa-check"></i>Percentiles and the Five Number Summary</a><ul>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#percentiles"><i class="fa fa-check"></i>Percentiles</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#the-five-number-summary"><i class="fa fa-check"></i>The five number summary</a></li>
<li class="chapter" data-level="" data-path="percentiles-and-the-five-number-summary.html"><a href="percentiles-and-the-five-number-summary.html#boxplots"><i class="fa fa-check"></i>Boxplots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html"><i class="fa fa-check"></i>Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html#range-and-interquartile-range"><i class="fa fa-check"></i>Range and interquartile range</a></li>
<li class="chapter" data-level="" data-path="measuring-the-spread-of-a-distribution.html"><a href="measuring-the-spread-of-a-distribution.html#variance-and-standard-deviation"><i class="fa fa-check"></i>Variance and standard deviation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="measuring-association-1.html"><a href="measuring-association-1.html"><i class="fa fa-check"></i>Measuring Association</a><ul>
<li class="chapter" data-level="" data-path="the-two-way-table.html"><a href="the-two-way-table.html"><i class="fa fa-check"></i>The Two-Way Table</a><ul>
<li class="chapter" data-level="" data-path="the-two-way-table.html"><a href="the-two-way-table.html#conditional-distributions"><i class="fa fa-check"></i>Conditional distributions</a></li>
<li class="chapter" data-level="" data-path="the-two-way-table.html"><a href="the-two-way-table.html#odds-ratio-advanced"><i class="fa fa-check"></i>Odds ratio (advanced)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html"><i class="fa fa-check"></i>Mean Differences</a><ul>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html#graphically-examining-differences-in-distributions"><i class="fa fa-check"></i>Graphically examining differences in distributions</a></li>
<li class="chapter" data-level="" data-path="mean-differences.html"><a href="mean-differences.html#comparing-differences-in-the-mean"><i class="fa fa-check"></i>Comparing differences in the mean</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html"><i class="fa fa-check"></i>Scatterplot and Correlation Coefficient</a><ul>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html#the-scatterplot"><i class="fa fa-check"></i>The scatterplot</a></li>
<li class="chapter" data-level="" data-path="scatterplot-and-correlation-coefficient.html"><a href="scatterplot-and-correlation-coefficient.html#the-correlation-coefficient"><i class="fa fa-check"></i>The correlation coefficient</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i>Statistical Inference</a><ul>
<li class="chapter" data-level="" data-path="the-problem-of-statistical-inference.html"><a href="the-problem-of-statistical-inference.html"><i class="fa fa-check"></i>The Problem of Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html"><i class="fa fa-check"></i>The Concept of the Sampling Distribution</a><ul>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#example-class-height"><i class="fa fa-check"></i>Example: class height</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#central-limit-theorem-and-the-normal-distribution"><i class="fa fa-check"></i>Central limit theorem and the normal distribution</a></li>
<li class="chapter" data-level="" data-path="the-concept-of-the-sampling-distribution.html"><a href="the-concept-of-the-sampling-distribution.html#what-can-we-do-with-the-sampling-distribution"><i class="fa fa-check"></i>What can we do with the sampling distribution?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i>Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#what-do-we-mean-by-confident"><i class="fa fa-check"></i>What do we mean by “confident?”</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#calculating-the-confidence-interval-for-the-sample-mean"><i class="fa fa-check"></i>Calculating the confidence interval for the sample mean</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#calculating-the-confidence-interval-for-other-sample-statistics"><i class="fa fa-check"></i>Calculating the confidence interval for other sample statistics</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-proportions"><i class="fa fa-check"></i>Example with proportions</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-mean-differences"><i class="fa fa-check"></i>Example with mean differences</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-proportion-differences"><i class="fa fa-check"></i>Example with proportion differences</a></li>
<li class="chapter" data-level="" data-path="confidence-intervals.html"><a href="confidence-intervals.html#example-with-correlation-coefficient"><i class="fa fa-check"></i>Example with correlation coefficient</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i>Hypothesis Tests</a><ul>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#example-coke-winners"><i class="fa fa-check"></i>Example: Coke winners</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#the-general-procedure-of-hypothesis-testing"><i class="fa fa-check"></i>The general procedure of hypothesis testing</a></li>
<li class="chapter" data-level="" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#hypothesis-tests-of-relationships"><i class="fa fa-check"></i>Hypothesis tests of relationships</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-models-1.html"><a href="building-models-1.html"><i class="fa fa-check"></i>Building Models</a><ul>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html"><i class="fa fa-check"></i>The OLS Regression Line</a><ul>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#the-formula-for-a-line"><i class="fa fa-check"></i>The Formula for a Line</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#calculating-the-best-fitting-line"><i class="fa fa-check"></i>Calculating the Best-Fitting Line</a></li>
<li><a href="the-ols-regression-line.html#using-the-lm-command-to-calculate-ols-regression-lines-in-r">Using the <code>lm</code> command to calculate OLS regression lines in <em>R</em></a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#adding-an-ols-regression-line-to-a-plot"><i class="fa fa-check"></i>Adding an OLS regression line to a plot</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#the-ols-regression-line-as-a-model"><i class="fa fa-check"></i>The OLS regression line as a model</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#interpeting-slopes-and-intercepts"><i class="fa fa-check"></i>Interpeting Slopes and Intercepts</a></li>
<li><a href="the-ols-regression-line.html#how-good-is-x-as-a-predictor-of-y">How good is <span class="math inline">\(x\)</span> as a predictor of <span class="math inline">\(y\)</span>?</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#inference-for-ols-regression-models"><i class="fa fa-check"></i>Inference for OLS Regression models</a></li>
<li class="chapter" data-level="" data-path="the-ols-regression-line.html"><a href="the-ols-regression-line.html#regression-line-cautions"><i class="fa fa-check"></i>Regression Line Cautions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html"><i class="fa fa-check"></i>The Power of Controlling for Other Variables</a><ul>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#interpreting-results-in-a-multivariate-ols-regression-models"><i class="fa fa-check"></i>Interpreting results in a multivariate OLS regression models</a></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#including-more-than-two-independent-variables"><i class="fa fa-check"></i>Including more than two independent variables</a></li>
<li class="chapter" data-level="" data-path="the-power-of-controlling-for-other-variables.html"><a href="the-power-of-controlling-for-other-variables.html#how-to-read-a-table-of-regression-results"><i class="fa fa-check"></i>How to read a table of regression results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html"><i class="fa fa-check"></i>Including Categorical Variables as Predictors</a><ul>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#indicator-variables"><i class="fa fa-check"></i>Indicator variables</a></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#categorical-variables-with-more-than-two-categories"><i class="fa fa-check"></i>Categorical variables with more than two categories</a></li>
<li class="chapter" data-level="" data-path="including-categorical-variables-as-predictors.html"><a href="including-categorical-variables-as-predictors.html#categorical-and-quantitative-variables-combined-in-a-single-model"><i class="fa fa-check"></i>Categorical and quantitative variables combined in a single model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html"><i class="fa fa-check"></i>Interaction Terms</a><ul>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#the-nature-of-additive-models"><i class="fa fa-check"></i>The nature of additive models</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#the-interaction-term"><i class="fa fa-check"></i>The interaction term</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interpreting-interaction-terms"><i class="fa fa-check"></i>Interpreting interaction terms</a></li>
<li><a href="interaction-terms.html#interaction-terms-in-r">Interaction terms in <em>R</em></a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interaction-terms-with-multiple-categories"><i class="fa fa-check"></i>Interaction terms with multiple categories</a></li>
<li class="chapter" data-level="" data-path="interaction-terms.html"><a href="interaction-terms.html#interaction-terms-with-two-categorical-variables"><i class="fa fa-check"></i>Interaction terms with two categorical variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-complications.html"><a href="model-complications.html"><i class="fa fa-check"></i>Model Complications</a><ul>
<li class="chapter" data-level="" data-path="the-linear-model-revisited.html"><a href="the-linear-model-revisited.html"><i class="fa fa-check"></i>The Linear Model, Revisited</a><ul>
<li class="chapter" data-level="" data-path="the-linear-model-revisited.html"><a href="the-linear-model-revisited.html#reformulating-the-linear-model"><i class="fa fa-check"></i>Reformulating the linear model</a></li>
<li class="chapter" data-level="" data-path="the-linear-model-revisited.html"><a href="the-linear-model-revisited.html#marginal-effects"><i class="fa fa-check"></i>Marginal effects</a></li>
<li class="chapter" data-level="" data-path="the-linear-model-revisited.html"><a href="the-linear-model-revisited.html#linear-model-assumptions"><i class="fa fa-check"></i>Linear model assumptions</a></li>
<li class="chapter" data-level="" data-path="the-linear-model-revisited.html"><a href="the-linear-model-revisited.html#estimating-a-linear-model"><i class="fa fa-check"></i>Estimating a linear model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html"><i class="fa fa-check"></i>Modeling Non-Linearity</a><ul>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html#smoothing"><i class="fa fa-check"></i>Smoothing</a></li>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html#residual-plots"><i class="fa fa-check"></i>Residual Plots</a></li>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html#transformations"><i class="fa fa-check"></i>Transformations</a></li>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html#polynomial-models"><i class="fa fa-check"></i>Polynomial Models</a></li>
<li class="chapter" data-level="" data-path="modeling-non-linearity.html"><a href="modeling-non-linearity.html#splines"><i class="fa fa-check"></i>Splines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html"><i class="fa fa-check"></i>The IID Violation and Robust Standard Errors</a><ul>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html#violations-of-independence"><i class="fa fa-check"></i>Violations of independence</a></li>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html#heteroscedasticity"><i class="fa fa-check"></i>Heteroscedasticity</a></li>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html#fixing-iid-violations"><i class="fa fa-check"></i>Fixing IID violations</a></li>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html#weighted-least-squares"><i class="fa fa-check"></i>Weighted least squares</a></li>
<li class="chapter" data-level="" data-path="the-iid-violation-and-robust-standard-errors.html"><a href="the-iid-violation-and-robust-standard-errors.html#robust-standard-errors"><i class="fa fa-check"></i>Robust standard errors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sample-design-and-weighting.html"><a href="sample-design-and-weighting.html"><i class="fa fa-check"></i>Sample Design and Weighting</a><ul>
<li class="chapter" data-level="" data-path="sample-design-and-weighting.html"><a href="sample-design-and-weighting.html#clustermultistage-sampling"><i class="fa fa-check"></i>Cluster/multistage sampling</a></li>
<li class="chapter" data-level="" data-path="sample-design-and-weighting.html"><a href="sample-design-and-weighting.html#stratification"><i class="fa fa-check"></i>Stratification</a></li>
<li class="chapter" data-level="" data-path="sample-design-and-weighting.html"><a href="sample-design-and-weighting.html#weights"><i class="fa fa-check"></i>Weights</a></li>
<li class="chapter" data-level="" data-path="sample-design-and-weighting.html"><a href="sample-design-and-weighting.html#correcting-for-sample-design-in-models"><i class="fa fa-check"></i>Correcting for sample design in models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i>Missing Values</a><ul>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html#identifying-valid-skips"><i class="fa fa-check"></i>Identifying Valid Skips</a></li>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html#kinds-of-missingness"><i class="fa fa-check"></i>Kinds of Missingness</a></li>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html#removing-cases"><i class="fa fa-check"></i>Removing Cases</a></li>
<li class="chapter" data-level="" data-path="missing-values.html"><a href="missing-values.html#imputation"><i class="fa fa-check"></i>Imputation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html"><i class="fa fa-check"></i>Multicollinearity and Scale Creation</a><ul>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html#avoid-the-singularity"><i class="fa fa-check"></i>Avoid the Singularity</a></li>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html#detecting-data-based-multicollinearity"><i class="fa fa-check"></i>Detecting Data-Based Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html#addressing-multicollinearity"><i class="fa fa-check"></i>Addressing Multicollinearity</a></li>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html#creating-scales"><i class="fa fa-check"></i>Creating Scales</a></li>
<li class="chapter" data-level="" data-path="multicollinearity-and-scale-creation.html"><a href="multicollinearity-and-scale-creation.html#factor-analysis"><i class="fa fa-check"></i>Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i>Model Selection</a><ul>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#there-is-no-right-model"><i class="fa fa-check"></i>There is no “right” model</a></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#the-accuracy-vs.-parsimony-tradeoff"><i class="fa fa-check"></i>The accuracy vs. parsimony tradeoff</a></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#null-vs.-saturated-model"><i class="fa fa-check"></i>Null vs. saturated model</a></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#a-not-very-useful-tool-the-f-test"><i class="fa fa-check"></i>A not-very-useful tool: the F-test</a></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#tools-with-a-parsimony-penalty"><i class="fa fa-check"></i>Tools with a parsimony penalty</a></li>
<li class="chapter" data-level="" data-path="model-selection.html"><a href="model-selection.html#model-averaging"><i class="fa fa-check"></i>Model Averaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="modeling-categorical-outcomes.html"><a href="modeling-categorical-outcomes.html"><i class="fa fa-check"></i>Modeling Categorical Outcomes</a><ul>
<li class="chapter" data-level="" data-path="dichotomous-outcomes-and-the-binomial-distribution.html"><a href="dichotomous-outcomes-and-the-binomial-distribution.html"><i class="fa fa-check"></i>Dichotomous Outcomes and The Binomial Distribution</a><ul>
<li class="chapter" data-level="" data-path="dichotomous-outcomes-and-the-binomial-distribution.html"><a href="dichotomous-outcomes-and-the-binomial-distribution.html#the-binomial-distribution"><i class="fa fa-check"></i>The binomial distribution</a></li>
<li class="chapter" data-level="" data-path="dichotomous-outcomes-and-the-binomial-distribution.html"><a href="dichotomous-outcomes-and-the-binomial-distribution.html#the-binomial-distribution-as-a-data-generating-process"><i class="fa fa-check"></i>The binomial distribution as a data-generating process</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-probability-model.html"><a href="linear-probability-model.html"><i class="fa fa-check"></i>Linear Probability Model</a><ul>
<li class="chapter" data-level="" data-path="linear-probability-model.html"><a href="linear-probability-model.html#heteroscedasticity-1"><i class="fa fa-check"></i>Heteroscedasticity</a></li>
<li class="chapter" data-level="" data-path="linear-probability-model.html"><a href="linear-probability-model.html#nonsense-values"><i class="fa fa-check"></i>Nonsense values</a></li>
<li class="chapter" data-level="" data-path="linear-probability-model.html"><a href="linear-probability-model.html#logit-transformation-to-the-rescue"><i class="fa fa-check"></i>Logit transformation to the rescue</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#generalized-linear-model-framework"><i class="fa fa-check"></i>Generalized linear model framework</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#a-glm-for-dichotomous-outcomes"><i class="fa fa-check"></i>A GLM for dichotomous outcomes</a></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html"><i class="fa fa-check"></i>Logit Model</a><ul>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html#interpreting-results"><i class="fa fa-check"></i>Interpreting results</a></li>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html#marginal-effects-1"><i class="fa fa-check"></i>Marginal effects</a></li>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html#the-probit-link"><i class="fa fa-check"></i>The probit link</a></li>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html#assessing-model-fit"><i class="fa fa-check"></i>Assessing model fit</a></li>
<li class="chapter" data-level="" data-path="logit-model.html"><a href="logit-model.html#separation"><i class="fa fa-check"></i>Separation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models-for-polytomous-outcomes.html"><a href="models-for-polytomous-outcomes.html"><i class="fa fa-check"></i>Models for Polytomous Outcomes</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="" data-path="useful-references.html"><a href="useful-references.html"><i class="fa fa-check"></i>Useful References</a><ul>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html"><i class="fa fa-check"></i>Example Datasets</a><ul>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#crimes"><i class="fa fa-check"></i>Crimes</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#movies"><i class="fa fa-check"></i>Movies</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#politics"><i class="fa fa-check"></i>Politics</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#popularity"><i class="fa fa-check"></i>Popularity</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#sex"><i class="fa fa-check"></i>Sex</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#titanic"><i class="fa fa-check"></i>Titanic</a></li>
<li class="chapter" data-level="" data-path="example-datasets.html"><a href="example-datasets.html#wages"><i class="fa fa-check"></i>Wages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html"><i class="fa fa-check"></i>Common R Commands</a><ul>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html#univariate-statistics"><i class="fa fa-check"></i>Univariate Statistics</a></li>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html#bivariate-statistics"><i class="fa fa-check"></i>Bivariate Statistics</a></li>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html#statistical-inference-1"><i class="fa fa-check"></i>Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html#ols-regression-models"><i class="fa fa-check"></i>OLS Regression Models</a></li>
<li class="chapter" data-level="" data-path="common-r-commands.html"><a href="common-r-commands.html#utility-functions"><i class="fa fa-check"></i>Utility functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html"><i class="fa fa-check"></i>Plotting Cookbook</a><ul>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#barplots"><i class="fa fa-check"></i>Barplots</a></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#histograms"><i class="fa fa-check"></i>Histograms</a></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#boxplots-1"><i class="fa fa-check"></i>Boxplots</a></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#comparative-barplots"><i class="fa fa-check"></i>Comparative Barplots</a></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#comparative-boxplots"><i class="fa fa-check"></i>Comparative Boxplots</a></li>
<li class="chapter" data-level="" data-path="plotting-cookbook.html"><a href="plotting-cookbook.html#scatterplots"><i class="fa fa-check"></i>Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-stat-lab.html"><a href="r-stat-lab.html"><i class="fa fa-check"></i>R Stat Lab</a><ul>
<li class="chapter" data-level="" data-path="using-scripts.html"><a href="using-scripts.html"><i class="fa fa-check"></i>Using Scripts</a><ul>
<li class="chapter" data-level="" data-path="using-scripts.html"><a href="using-scripts.html#getting-started-with-scripts"><i class="fa fa-check"></i>Getting Started with Scripts</a></li>
<li class="chapter" data-level="" data-path="using-scripts.html"><a href="using-scripts.html#not-everything-goes-into-your-script"><i class="fa fa-check"></i>Not Everything Goes Into Your Script</a></li>
<li class="chapter" data-level="" data-path="using-scripts.html"><a href="using-scripts.html#commenting-for-sanity"><i class="fa fa-check"></i>Commenting for Sanity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html"><i class="fa fa-check"></i>Object Types</a><ul>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#atomic-modes"><i class="fa fa-check"></i>Atomic Modes</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#vectors-and-matrices"><i class="fa fa-check"></i>Vectors and Matrices</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#factors"><i class="fa fa-check"></i>Factors</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#logical-values-and-boolean-statements"><i class="fa fa-check"></i>Logical Values and Boolean Statements</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#missing-values-1"><i class="fa fa-check"></i>Missing Values</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#lists"><i class="fa fa-check"></i>Lists</a></li>
<li class="chapter" data-level="" data-path="object-types.html"><a href="object-types.html#data-frames"><i class="fa fa-check"></i>Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pretty-pictures.html"><a href="pretty-pictures.html"><i class="fa fa-check"></i>Pretty Pictures</a><ul>
<li class="chapter" data-level="" data-path="pretty-pictures.html"><a href="pretty-pictures.html#base-plot"><i class="fa fa-check"></i>Base Plot</a></li>
<li class="chapter" data-level="" data-path="pretty-pictures.html"><a href="pretty-pictures.html#ggplot"><i class="fa fa-check"></i>ggplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-git.html"><a href="using-git.html"><i class="fa fa-check"></i>Using Git</a><ul>
<li class="chapter" data-level="" data-path="using-git.html"><a href="using-git.html#plain-text-is-better"><i class="fa fa-check"></i>Plain Text is Better</a></li>
<li class="chapter" data-level="" data-path="using-git.html"><a href="using-git.html#git"><i class="fa fa-check"></i>Git</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i>Reading and Writing Data</a><ul>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#data-formats"><i class="fa fa-check"></i>Data Formats</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#plain-text-files"><i class="fa fa-check"></i>Plain text files</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#data-in-binary-format"><i class="fa fa-check"></i>Data in binary format</a></li>
<li class="chapter" data-level="" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#saving-data"><i class="fa fa-check"></i>Saving data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html"><i class="fa fa-check"></i>Cleaning Data</a><ul>
<li><a href="cleaning-data.html#the-most-important-rule-check-yourself-before-you-wreck-yourself">The Most Important Rule: <span>Check yourself before you wreck yourself</span></a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#assigning-missing-values"><i class="fa fa-check"></i>Assigning missing values</a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#recoding"><i class="fa fa-check"></i>Recoding</a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#collapsing-categorical-variables"><i class="fa fa-check"></i>Collapsing Categorical Variables</a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#transforming-quantitative-variables"><i class="fa fa-check"></i>Transforming Quantitative Variables</a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#after-cleaning-you-still-need-to-tidy"><i class="fa fa-check"></i>After Cleaning You Still Need to Tidy</a></li>
<li class="chapter" data-level="" data-path="cleaning-data.html"><a href="cleaning-data.html#aggregating-data"><i class="fa fa-check"></i>Aggregating Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reshaping-and-merging-data.html"><a href="reshaping-and-merging-data.html"><i class="fa fa-check"></i>Reshaping and Merging Data</a><ul>
<li class="chapter" data-level="" data-path="reshaping-and-merging-data.html"><a href="reshaping-and-merging-data.html#reshaping"><i class="fa fa-check"></i>Reshaping</a></li>
<li class="chapter" data-level="" data-path="reshaping-and-merging-data.html"><a href="reshaping-and-merging-data.html#merging-data"><i class="fa fa-check"></i>Merging data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i>Programming</a><ul>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#an-example-theils-h"><i class="fa fa-check"></i>An Example: Theil’s H</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#our-data"><i class="fa fa-check"></i>Our Data</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#calculating-theils-h-for-a-single-state"><i class="fa fa-check"></i>Calculating Theil’s H for a single state</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#creating-functions"><i class="fa fa-check"></i>Creating Functions</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#iteration"><i class="fa fa-check"></i>Iteration</a></li>
<li class="chapter" data-level="" data-path="programming.html"><a href="programming.html#putting-it-all-together"><i class="fa fa-check"></i>Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-r-markdown.html"><a href="using-r-markdown.html"><i class="fa fa-check"></i>Using R Markdown</a><ul>
<li class="chapter" data-level="" data-path="using-r-markdown.html"><a href="using-r-markdown.html#plain-text-science"><i class="fa fa-check"></i>Plain Text Science</a></li>
<li class="chapter" data-level="" data-path="using-r-markdown.html"><a href="using-r-markdown.html#markdown-syntax"><i class="fa fa-check"></i>Markdown Syntax</a></li>
<li class="chapter" data-level="" data-path="using-r-markdown.html"><a href="using-r-markdown.html#r-markdown"><i class="fa fa-check"></i>R Markdown</a></li>
<li class="chapter" data-level="" data-path="using-r-markdown.html"><a href="using-r-markdown.html#figures-in-r-markdown"><i class="fa fa-check"></i>Figures in R Markdown</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis in Sociology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pretty-pictures" class="section level2">
<h2>Pretty Pictures</h2>
<p>One of the best features of R is the ability to make beautiful graphs. R gives the user an incredible amount of control over exactly how your graphs appear. If you know enough, you can virtually make any graph that you can imagine in your head. This flexibility comes at a cost, however. The curve in learning graphics is quite substantial, because of the number of parameters that can be controlled. Nonetheless, if you intend to do quantitative data analysis, then its well worth the effort. In my opinion, figures are almost always a better way to express a result than a table. If the figure is well-designed it will make your results much more intelligible to a broader audience because you have literally helped them to visualize it.</p>
<p>In this lab, I am going to show you two techniques for plotting in R. First, I am going to show you how to plot things in R using the basic plotting functions, sometimes called “base plot.” Base plotting in R gives you full control over pretty much everything you could want to stick on a canvas, but sometimes it gives you too much control and you can end up fiddling around a lot to get things to look just how you want them to. So, I am also going to show you how to plot in R using the <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code> library</a>. ggplot has become so popular as a method of plotting that many people prefer it to base plot. The “gg” in ggplot refers to teh “graphics of grammar.” The basic idea of ggplot is that rather than control everything about your plot, you give R a “grammar” of what data you want to graph, how you want to graph, and how you want to tie aesthetics to the different pieces of data. In future versions of this course, I plan to transition many of the graphs we use to <code>ggplot</code> although most slides are still written in base plot.</p>
<p>There are two different ways you should use pictures in your work. The first method is to use figures to <strong>visualize what you data looks like</strong>. This is what we have been learning already in class. Histograms, barplots, boxplots, and scatterplots are all examples of trying to visualize your data. Most work on how to make figures is devoted to the topic of visualizing your data like this. However, there is a second way to use pictures, which I think is actually equally important and under-utilized. You can use figures to <strong>vizualize your findings</strong>. The difference here might not be immediately obvious, partly because we haven’t talked about “models” yet, which is the primary way that results are expressed in quantitative work. Let me give you an example from my own work that may help to communicate what I mean. Here is a figure from an AJS article that shows how to think about the results of a model I ran that tries to predict the number of lynchings in a county by the inequality in occupation between individuals classified as black and mulatto and the inequality between individuals classified as white and mulatto or black (i.e. “African ancestry”).</p>
<p><img src="resources/ajsboundaries.png" /></p>
<p>This is a heat (or topological) map of risk where dark areas indicate greater risk (of lynching). The point was to show that the effect of each variable produces opposite effects depending on the level of the other variable. I am not describing data here, but rather the results of a model of lynching risk that is based on the underlying county-level data.</p>
<p>Since we don’t know much about these types of models yet, we will focus for now on using graphs to describe data. The data we will look at come from one of my current projects. In this project, my colleague (Nicole Marwell) and I have data on social service contracts awarded by the City of New York to non-profit organizations working within the city. The data I am using here are created by aggregating all the money allocated to a particlar health area (a bureaucractic neighborhood boundary in NYC) between the years of 2009 and 2010. We combine that data with data on the poverty rate for each health areas and also divide by the population in a health area to get an estimate of the <strong>social service funding per capita.</strong> Here is a peak at what the data look like:</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb835-1" title="1"><span class="kw">head</span>(nyc)</a></code></pre></div>
<pre><code>##   health_area  amtcapita  poverty unemployed   income   borough     popn
## 1       10110  29.168592 22.77850  11.324410 40287.02 Manhattan 27983.43
## 2       10120 109.451055 22.62417  10.179587 43266.45 Manhattan 20235.00
## 3       10210 216.306532 30.08883  11.616439 29015.87 Manhattan 28688.00
## 4       10221  29.148974 27.16760  17.279031 33987.68 Manhattan 27161.08
## 5       10222   2.422527 12.10421   8.580756 66350.84 Manhattan 13372.73
## 6       10300 506.985063 27.39747  13.606836 32591.55 Manhattan 16035.99
##    lincome  poverty.z unemployed.z  lincome.z deprivation.summated
## 1 10.60378  0.1623016   0.65034173  0.2704751            0.3902136
## 2 10.67513  0.1496155   0.34143111  0.1183988            0.2195641
## 3 10.27560  0.7632204   0.72914069  0.9699954            0.8871098
## 4 10.43375  0.5230918   2.25709249  0.6328925            1.2296246
## 5 11.10271 -0.7151376  -0.08998557 -0.7929740           -0.5757443
## 6 10.39181  0.5419873   1.26621463  0.7222968            0.9116593</code></pre>
<p>We have the numeric code of the health area, the amount of funding per capita, the poverty rate as a percentage of the population, a numeric code for borough (Manhattan, Brooklyn, Bronx, Queens, Staten Island), and the population size. You can download this data in the files section of Canvas.</p>
<div id="base-plot" class="section level3">
<h3>Base Plot</h3>
<p>For this example, we are going to use a scatterplot to look at the association between funding per capita and poverty rates. Here is the ultimate figure that we want to end up with:</p>
<p><img src="stat_book_files/figure-html/prettyfull-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>There is a lot going on in this figure. Lets identify a few of the nifty features:</p>
<ul>
<li>dots are color-coded by borough</li>
<li>the scale of the y-axis is <em>logarithmic</em> which means that an increase of one unit is actually a multiplicative increase of 10 (sort of like the richter scale).</li>
<li>The size of dots is scaled to the population size of the health area.</li>
<li>There is a best-fitting line drawn through the points. It looks positive.</li>
<li>the y-axis has a dollar-sign and commas to make the numbers easier to read and the x-axis has a % marker to make clear the units.</li>
<li>there are two different legends drawn on the outside margins of the figure.</li>
</ul>
<p>Thats a lot of stuff. Lets start from the basics and build our way up to this final model. Lets start by just running the basic <code>plot</code> command for a scatterplot:</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb837-1" title="1"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ok, thats a lot different. Lets deal with the biggest substantive problem. The amount per capita is so heavily right-skewed that it is difficult to see the relationship because almost all of the data points are “squished” down at the bottom of the y-axis. This can be resolved by using whats called a <em>logarithmic scale</em> such that each tick mark indicates not an additive unit increase on the y-axis but a multiplicative increase. We can do this easily by specifying “y” as an option to the <code>log</code> argument in <code>plot</code>:</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb838-1" title="1"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb838-2" title="2">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ok, that looks better. This graphical approach is related to the idea of <strong>tranformations</strong> that we will discuss later in the term. Now we can better see that there is a positive effect. However, the numbers on the y-axis tick-marks look horrible. Instead of using the default tickmarks, I can specify my own axis. A quick check using <code>summary</code> reveals that the maximum amount per capita is $12,290. If I am going up by multiples of ten, the next tick mark above this would be 100,000 (from 10,000, to 100,000). So, I am going to do a few things in the next command. First, I am going to use <code>yaxt="n"</code> to tell R not to draw the default y-axis. Then I am going to use <code>ylim=c(0.1,100000)</code> to specify the upper and lower limits on my y-axis.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb839-1" title="1"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb839-2" title="2">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that there is now no y-axis tickmarks. I can define those myself with the <code>axis</code> command.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb840-1" title="1"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb840-2" title="2">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))</a>
<a class="sourceLine" id="cb840-3" title="3"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>2</code> argument tells R to draw the axis for the y-axis and the <code>at</code> argument allows me to specify where I want the tick marks. The <code>las</code> argument specifies that I want my tickmark labels to be perpendicular to the axis, for easier reading. There are still a couple of problems with this axis. First, the label for the y-axis is now overlapping with the tickmark labels. Second, the tickmark labels are in an ugly exponential notation. These can both be fixed. First, I can fix the tickmark labels. There are a variety of functions such as <code>paste</code>, <code>format</code>, and <code>formatC</code> which will allow you to turn numbers into pretty well-formatted character strings. In this case, I am going to use those functions to write out the full number with a comma at the thousands place and put a dollar sign in front:</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb841-1" title="1"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb841-2" title="2">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>))</a>
<a class="sourceLine" id="cb841-3" title="3"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb841-4" title="4">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb841-5" title="5">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I am not going to go over the details of these commands here, but you can see how the tickmark labels are much easier to read now. I still have the problem of the overlapping label for the y-axis and now, the left margin is also not quite large enough for the top label which is being cut-off.</p>
<p>To adjust the margin, let me introduce the <code>par</code> command. The <code>par</code> command can be called before the plot command to set up the parameters of the plot. If you look at the help file for <code>par</code> you will see that there are a huge number of parameters that we can adjust. In our case, we want to adjust the <code>mar</code> argument which is a vector of four numbers defining the size of the bottom, left, top, and right margins, respectively. The default for these is <code>c(5,4,4,2)</code>. I will increase the left margin slightly and reduce the right margin since we won’t use it. In addition, I am going to remove the default y label by specifying <code>ylab=""</code>.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb842-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb842-2" title="2"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb842-3" title="3">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>)</a>
<a class="sourceLine" id="cb842-4" title="4"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb842-5" title="5">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb842-6" title="6">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The final step is to define my own y-axis label. I can do this with the <code>title</code> command. If you look at the help file for the <code>title</code> command, you will see that in addition to telling R which title you want to add, you can specify the number of lines away from the graph for the title, which allows us to control its placement. After experimenting around a bit, I discovered that <code>line=5</code> looked nice.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb843-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb843-2" title="2"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb843-3" title="3">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb843-4" title="4"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb843-5" title="5">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb843-6" title="6">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb843-7" title="7"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The y-axis now looks pretty good. I was able to override the default y-axis with the <code>yaxt="n"</code> and <code>ylab=""</code> arguments to <code>plot</code> and then use the <code>axis</code> and <code>title</code> commands to customize tick marks and labels. Now, I will do the same to the x-axis:</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb844-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb844-2" title="2"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb844-3" title="3">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb844-4" title="4">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>)</a>
<a class="sourceLine" id="cb844-5" title="5"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb844-6" title="6">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb844-7" title="7">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb844-8" title="8"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb844-9" title="9"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In this case, I didn’t have to define a separate title, because the default x-axis label fits fine. I also don’t need the <code>las</code> command because the default has the correct alignment.</p>
<p>Now that I have my axes well-labeled. I can focus on the actual plot. The default “dots” for scatterplots in R are prety ugly, but there are lots of options for better dots. You can specify the shape and style of the dot with the <code>pch</code> argument in plot. If you use <code>?points</code>, the help file will give you a list of the numeric codes that correspond to different kinds of dots. I usually use <code>pch=21</code> because it will give me a circle that has a separate border and fill color. The border color can be specified by the <code>col</code> argument an the fill color can be specified by the <code>bg</code> argument. I can also use the <code>cex</code> option to define the size of the dots (relative to the default of 1). I will use this now to create circles of half the average size with a red fill and a black border.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb845-1" title="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)</a>
<a class="sourceLine" id="cb845-2" title="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb845-3" title="3"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb845-4" title="4">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb845-5" title="5">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb845-6" title="6">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb845-7" title="7"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb845-8" title="8">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb845-9" title="9">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb845-10" title="10"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb845-11" title="11"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is now pretty good, but the final touch here is to vary the size of the dots by the size of the health area and the fill color by the borough of the health area. R is very flexible about these types of arguments. If I give a vector of numbers for the size or a vector of colornames for the fill color, R will assume that those colors correspond to the individual dots and will allow for variation in the size and color. For example, lets just feed in population size divided by 10,000 to <code>cex</code>.</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb846-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb846-2" title="2"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb846-3" title="3">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb846-4" title="4">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb846-5" title="5">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span>nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb846-6" title="6"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb846-7" title="7">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb846-8" title="8">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb846-9" title="9"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb846-10" title="10"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Well, that sort of worked but some of those dots are way too big and some are way too small. The variation in size between health areas is so large that any kind of linear scaling of the population size is going to result in this problem. There are a variety of potential solutions to this, but our earlier use of logarithmic scales suggests an easy one. Logging the population values will allow for differences in size but at a diminishing scale difference. After experimentation, I decided that dividing population size by 3000 and logging with a base of 5 produced good size variation.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb847-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb847-2" title="2"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb847-3" title="3">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb847-4" title="4">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb847-5" title="5">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;red&quot;</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb847-6" title="6"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb847-7" title="7">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb847-8" title="8">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb847-9" title="9"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb847-10" title="10"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The final step is to color-code the dots. I could put in a vector of any five colors. However, it is important to think about accessibility for color-blind individuals and whether a color combination will show up well in print. There are many online resources for this sort of thing. I like <a href="http://colorbrewer2.org/#type=diverging&amp;scheme=RdBu&amp;n=5">ColorBrewer</a>. Here I have specified five classes with a diverging scheme that are colorblind and print friendly. I wiould have selected qualitative scale but there are no color-blind options in that category for five classes. ColorBrewer gives me some options with hexadecimal color codes which I can feed into R. I first create a vector of the five color names and then I use the borough index to assign them in my plot command.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb848-1" title="1">color_choices &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#ca0020&quot;</span>,<span class="st">&quot;#f4a582&quot;</span>,<span class="st">&quot;#f7f7f7&quot;</span>,<span class="st">&quot;#92c5de&quot;</span>,<span class="st">&quot;#0571b0&quot;</span>)</a>
<a class="sourceLine" id="cb848-2" title="2"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb848-3" title="3"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb848-4" title="4">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb848-5" title="5">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb848-6" title="6">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb848-7" title="7"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb848-8" title="8">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb848-9" title="9">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb848-10" title="10"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb848-11" title="11"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty12-1.png" width="672" style="display: block; margin: auto;" />
We are almost there but I also want to add a best-fitting line. Normally, I could do this with the <code>abline</code> command as discussed in the Canvas section on the OLS regression line. However, that won’t work in this case because of the the logarithmic scale on the y-axis. Instead, I can create a sequence of poverty rate values and then based on a model, I can calculate the predicted amount per capita (note that you don’t know how to do this yet, so just hang tight). I can then feed those x and y values into a <code>lines</code> command to draw a line on my plot.</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb849-1" title="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)</a>
<a class="sourceLine" id="cb849-2" title="2">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb849-3" title="3">y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x</a>
<a class="sourceLine" id="cb849-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb849-5" title="5"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb849-6" title="6">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb849-7" title="7">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb849-8" title="8">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), </a>
<a class="sourceLine" id="cb849-9" title="9">     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb849-10" title="10"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb849-11" title="11">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb849-12" title="12">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb849-13" title="13"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb849-14" title="14"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb849-15" title="15"><span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I don’t want you to worry to much about the model part. The important feature I want to highlight here is that <code>lines</code> is one of a number of commands that include <code>points</code>, <code>text</code>, and <code>mtext</code> that you can use to later add other stuff to a plot that you have already made. In this case, I have added a straight line. The <code>lwd</code> argument defines the width of the line and the <code>col</code> argument defines the color of the line.</p>
<p>I snuck in one other argument here that made a noticeable change. The argument <code>bty</code> defines how the border is drawn around the overall plot area. By setting this to “n”, I removed the border altogether, which I think gives it a cleaner look.</p>
<p>The last step is to add some legends. Legends can be tricky. The first thing you have to figure out is where to place the legend. In my case, I would rather have the legend in the margin than in the main plot area, but R won’t do this by default. In order to do that, I need to specify an <code>xpd=TRUE</code> argument in the <code>par</code> command to allow writing output to the margins and not just the main plot area. In the <code>legend</code> command itself, I need to make a label for each component of the legend and then I need to specify how each component is identified. Lets start with the legend for boroughs.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb850-1" title="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)</a>
<a class="sourceLine" id="cb850-2" title="2">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb850-3" title="3">y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x</a>
<a class="sourceLine" id="cb850-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">xpd=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb850-5" title="5"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb850-6" title="6">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb850-7" title="7">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb850-8" title="8">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), </a>
<a class="sourceLine" id="cb850-9" title="9">     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb850-10" title="10"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb850-11" title="11">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb850-12" title="12">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb850-13" title="13"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb850-14" title="14"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb850-15" title="15"><span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)</a>
<a class="sourceLine" id="cb850-16" title="16">lg &lt;-<span class="st"> </span><span class="kw">legend</span>(<span class="dv">0</span>, <span class="dv">100000</span>, </a>
<a class="sourceLine" id="cb850-17" title="17">             <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Bronx&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Staten Island&quot;</span>), </a>
<a class="sourceLine" id="cb850-18" title="18">             <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">pt.bg=</span>color_choices, <span class="dt">ncol=</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb850-19" title="19">             <span class="dt">cex=</span><span class="fl">0.45</span>, <span class="dt">pt.cex=</span><span class="fl">1.2</span>, <span class="dt">yjust=</span><span class="dv">5</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The first two arguments to <code>legend</code> give the x and y placement. The <code>legend</code> argument to <code>legend</code> (I know, its weird) gives the labels for the legend components. The <code>pch</code> argument tells the legend that I am using points and what their shape is. The <code>col</code> argument gives the border color for these points and the <code>pt.bg</code> argument gives their fill color. The <code>ncol</code> tells the legend to use five separate columns rather than a vertical alignment all in one column. The <code>cex</code> and <code>pt.cex</code> arguments indicate the size of the overall legend and the size of the dots, respectively. The <code>yjust</code> argument allows me to fudge the placement to get it just right.</p>
<p>Notice, that I saved the output of legend to an object that I called <code>lg</code>. This is a very useful feature of plots. I want to draw my next legend for health area size next to this first legend, but I have no idea exactly how big the first legend will be, so its hard to know at what value of x to start it. I could guess a number here, but that might also change if I rescale the figure manually. However, if I look at the <code>lg</code> object, the information I am looking for is returned there:</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb851-1" title="1">lg</a></code></pre></div>
<pre><code>## $rect
## $rect$w
## [1] 33.53141
## 
## $rect$h
## [1] 0.486
## 
## $rect$left
## [1] 0
## 
## $rect$top
## [1] 3.056
## 
## 
## $text
## $text$x
## [1]  1.562143  8.190318 14.818492 21.446667 28.074842
## 
## $text$y
## [1] 2.813 2.813 2.813 2.813 2.813</code></pre>
<p>In this specific case, I am looking for <code>lg$rect$w</code> which gives the width of the first legend. I can use that to set up the placement of my second legend:</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb853-1" title="1">model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(nyc<span class="op">$</span>amtcapita))<span class="op">~</span>nyc<span class="op">$</span>poverty)</a>
<a class="sourceLine" id="cb853-2" title="2">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">60</span></a>
<a class="sourceLine" id="cb853-3" title="3">y &lt;-<span class="st"> </span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(model<span class="op">$</span>coef[<span class="dv">2</span>])<span class="op">^</span>x</a>
<a class="sourceLine" id="cb853-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">xpd=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb853-5" title="5"><span class="kw">plot</span>(nyc<span class="op">$</span>poverty, nyc<span class="op">$</span>amtcapita, </a>
<a class="sourceLine" id="cb853-6" title="6">     <span class="dt">log=</span><span class="st">&quot;y&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">100000</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb853-7" title="7">     <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>), <span class="dt">xlab=</span><span class="st">&quot;Poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb853-8" title="8">     <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span>color_choices[nyc<span class="op">$</span>borough], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">cex=</span><span class="kw">log</span>(nyc<span class="op">$</span>popn<span class="op">/</span><span class="dv">3000</span>,<span class="dv">5</span>), </a>
<a class="sourceLine" id="cb853-9" title="9">     <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb853-10" title="10"><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">at=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), <span class="dt">las=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb853-11" title="11">     <span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&quot;$&quot;</span>,<span class="kw">formatC</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>,<span class="dv">100000</span>), </a>
<a class="sourceLine" id="cb853-12" title="12">                                  <span class="dt">format=</span><span class="st">&quot;d&quot;</span>, <span class="dt">big.mark=</span><span class="st">&quot;,&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb853-13" title="13"><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;amount per capita&quot;</span>, <span class="dt">line=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb853-14" title="14"><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">60</span>,<span class="dt">by=</span><span class="dv">10</span>),<span class="st">&quot;%&quot;</span>,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb853-15" title="15"><span class="kw">lines</span>(x,y, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;grey20&quot;</span>)</a>
<a class="sourceLine" id="cb853-16" title="16">lg &lt;-<span class="st"> </span><span class="kw">legend</span>(<span class="dv">0</span>, <span class="dv">100000</span>, </a>
<a class="sourceLine" id="cb853-17" title="17">             <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Bronx&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Staten Island&quot;</span>), </a>
<a class="sourceLine" id="cb853-18" title="18">             <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">pt.bg=</span>color_choices, <span class="dt">ncol=</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb853-19" title="19">             <span class="dt">cex=</span><span class="fl">0.45</span>, <span class="dt">pt.cex=</span><span class="fl">1.2</span>, <span class="dt">yjust=</span><span class="op">-</span><span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb853-20" title="20"><span class="kw">legend</span>(lg<span class="op">$</span>rect<span class="op">$</span>w<span class="op">*</span><span class="fl">1.05</span>, <span class="dv">100000</span>, </a>
<a class="sourceLine" id="cb853-21" title="21">       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;5000 people&quot;</span>,<span class="st">&quot;50,000 people&quot;</span>,<span class="st">&quot;100,000 people&quot;</span>),</a>
<a class="sourceLine" id="cb853-22" title="22">       <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pt.bg=</span><span class="st">&quot;grey&quot;</span>,<span class="dt">ncol=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb853-23" title="23">       <span class="dt">pt.cex=</span><span class="kw">log</span>(<span class="kw">c</span>(<span class="dv">5000</span>,<span class="dv">50000</span>,<span class="dv">100000</span>)<span class="op">/</span><span class="dv">3000</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb853-24" title="24">       <span class="dt">yjust=</span><span class="op">-</span><span class="fl">0.7</span>, <span class="dt">cex=</span><span class="fl">0.45</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/pretty16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And there is the final product. Keep in mind that some of the final touches here are fairly complex. I am not expecting you to be able to produce graphs of this complexity tomorrow. The goal was to show you the richness and depth of graphing in R and to give you some reference points for beginning to build your own beautiful graphs.</p>
<p>The <code>plot</code> function is one of the most basic functions for creating plots and once you get the basics down you can create a wide variety of two-dimensional plots. However, there are a variety of other functions that will draw more specific plots. We have already seen examples of <code>pie</code>, <code>barplot</code>, <code>hist</code>, and <code>boxplot</code>. Most of the options for customization that are available for <code>plot</code> are also available for these other functions. For example, in the code here I use the <code>text</code> function to plot the actual percentage values at the top of my bars for a barplot of movie maturity rating and to create lines for the y-axis at 10% intervals.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb854-1" title="1">percent &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">table</span>(movies<span class="op">$</span>Rating)<span class="op">/</span><span class="kw">sum</span>(<span class="kw">table</span>(movies<span class="op">$</span>Rating)),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb854-2" title="2">b &lt;-<span class="st"> </span><span class="kw">barplot</span>(percent, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">&quot;Percent&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>), <span class="dt">col=</span><span class="st">&quot;salmon&quot;</span>)</a>
<a class="sourceLine" id="cb854-3" title="3"><span class="kw">text</span>(b[,<span class="dv">1</span>], percent<span class="op">+</span><span class="dv">2</span>, <span class="kw">paste</span>(percent, <span class="st">&quot;%&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb854-4" title="4"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">50</span>,<span class="dt">by=</span><span class="dv">10</span>), <span class="dt">lwd=</span><span class="fl">0.5</span>, <span class="dt">col=</span><span class="st">&quot;grey80&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/barplot_rating-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Another useful command that we haven’t learned yet is <code>matplot</code> which is short for matrix plotting. The <code>matplot</code> function will plot the values of one dimension of the matrix across the indices of the other dimension. This allows you to plot, for example, trend lines separately by different categories. Lets try it out by plotting the time trend in movie runtime separately by maturity rating. The first step in doing this is to calculate the mean of movie runtime by year and maturity rating using the <code>tapply</code> command.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb855-1" title="1">tab &lt;-<span class="st"> </span><span class="kw">tapply</span>(movies<span class="op">$</span>Runtime, movies[,<span class="kw">c</span>(<span class="st">&quot;Year&quot;</span>,<span class="st">&quot;Rating&quot;</span>)], mean)</a>
<a class="sourceLine" id="cb855-2" title="2">tab</a></code></pre></div>
<pre><code>##       Rating
## Year           G        PG    PG-13        R
##   2001  89.20000 101.43750 105.1667 107.1744
##   2002  92.66667  97.42308 107.0139 104.3974
##   2003  75.40000  96.08333 109.7143 108.1692
##   2004  93.00000  99.65714 106.2027 105.8769
##   2005  84.83333 100.76471 109.6024 107.8659
##   2006  93.85714  99.30233 107.2118 109.6282
##   2007  99.66667  99.37931 104.7324 107.8900
##   2008  91.44444 101.50000 105.8750 106.4935
##   2009  99.33333  98.24242 107.8481 104.1071
##   2010 103.00000 101.79412 109.4559 102.1495
##   2011  89.33333 100.84000 109.3297 101.5098
##   2012  88.00000  99.87500 109.4400 103.1043
##   2013 104.00000 100.81250 112.7971 103.4904</code></pre>
<p>Now, I can feed this matrix into <code>matplot</code> to see the trend across time. In this case, I am going to leave off NC-17 and Unrated because the small number of movies here makes these measures very noisy.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb857-1" title="1"><span class="kw">matplot</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;mean movie runtime&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/matplot_example-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>One interesting trend is that PG-13 movies have become longer than R movies, mostly because the runtime of R movies has gotten progressively smaller since 2006. G movies are also getting slight longer over time, but its highly variable from year to year.</p>
<p>I could have also created this plot with the basic <code>plot</code> command and some <code>lines</code> commands, like so:</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb858-1" title="1"><span class="kw">plot</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dt">xlab=</span><span class="st">&quot;year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;mean movie runtime&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb858-2" title="2">     <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">2001</span>,<span class="dv">2013</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">70</span>,<span class="dv">120</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb858-3" title="3"><span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">1</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb858-4" title="4"><span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">2</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb858-5" title="5"><span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">3</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)</a>
<a class="sourceLine" id="cb858-6" title="6"><span class="kw">lines</span>(<span class="dv">2001</span><span class="op">:</span><span class="dv">2013</span>, tab[,<span class="dv">4</span>], <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb858-7" title="7"><span class="kw">legend</span>(<span class="dv">2001</span>, <span class="dv">120</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;G&quot;</span>,<span class="st">&quot;PG&quot;</span>,<span class="st">&quot;PG-13&quot;</span>,<span class="st">&quot;R&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb858-8" title="8">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;purple&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="fl">0.7</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/matplot_example2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The plot command here basically creates an empty canvas because I give a single point coordinate (-1,-1) that is outside the range of my xlim and ylim values. I can then use the <code>lines</code> command to write specific lines onto this blank canvas.</p>
</div>
<div id="ggplot" class="section level3">
<h3>ggplot</h3>
<p>Now, I want to show you how to plot that same scatterplot of non-profit funding in NYC using ggplot.</p>
<p>Ggplot builds up a graph from layers. The first and most essential component is the function <code>ggplot</code> where I indicate the data I am using and the aesthetics that I want to be carried through to all of the other layers:</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb859-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty, <span class="dt">y=</span>amtcapita))</a></code></pre></div>
<p><img src="stat_book_files/figure-html/ggplot1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This command does not actually plot anything yet. It just sets up the basic structure of my plot by identifying the dataset and that I will use <code>poverty</code> as my <code>x</code> variable and <code>amtcapita</code> as my <code>y</code> variable. I then can add layers to this basic command using the “+” sign. For example, if I wanted to create a scatterplot by plotting points:</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb860-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty, <span class="dt">y=</span>amtcapita))<span class="op">+</span></a>
<a class="sourceLine" id="cb860-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="stat_book_files/figure-html/ggplot_scatter-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now, I have a basic (and very ugly) scatterplot that is similar to what I started with in base plot. I can now add a variety of layers to that start to make a better graph. There are three types of layers I can add:</p>
<ol style="list-style-type: decimal">
<li><code>geoms</code> - these are a variety of geometric patterns such as points, bars, lines, etc.</li>
<li>The <code>coords</code> that define the coordinate system used to plot the values. We typically won’t futz around with this much because everything is drawn on a Cartesian coordinate system, but it can be useful for maps and some other things.</li>
<li><code>scales</code> - these indicate how I want the scales of my various aesthetics to work. This can include the scaling of my x and y variables, but also things like color gradiations.</li>
<li><code>labels</code> - I can identify labels and themes to use.</li>
</ol>
<p>For example, let me use the <code>scale_y_log10()</code> function to re-scale my y-axis to a logarithmic basis:</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb861-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty, <span class="dt">y=</span>amtcapita))<span class="op">+</span></a>
<a class="sourceLine" id="cb861-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb861-3" title="3"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels=</span>dollar)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/ggplot_scale-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>That looks better. Notice that I also gave the <code>scale_y_log10</code> command an argument of <code>labels</code>. This argument identifies the specific labels I want to use for the tick mark. In this case, I am supplying a function from the <code>scales</code> library that turns raw numbers into formatted dollar amounts.</p>
<p>From here I can add a variety of layers and aesthetics to enrich my graph. Let me first add aesthetics for color and size. I will also tranform borough into a proper factor variable so it displays more nicelyin the legend.</p>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb862-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty, <span class="dt">y=</span>amtcapita, <span class="dt">size=</span>popn, <span class="dt">color=</span>borough))<span class="op">+</span></a>
<a class="sourceLine" id="cb862-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb862-3" title="3"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels=</span>dollar)<span class="op">+</span></a>
<a class="sourceLine" id="cb862-4" title="4"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Dark2&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb862-5" title="5"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="stat_book_files/figure-html/ggplot_clor-1.png" width="672" style="display: block; margin: auto;" />
By just adding in the borough and pop size as aesthetics, the graph was quickly adjusted. I didn’t have to fiddle around with exact sizing of the dots. Ggplot handled those details. Note that I also added a scale for the color using one of ggplot’s pre-defined palettes. I also used the argument of <code>alpha=0.7</code> to add some transparency to points, which helps me deal with issues of overplotting. Finally, I used <code>theme_bw()</code> at the bottom to change to a black and white theme.</p>
<p>I also want to add a line for the best-fitting OLS regressin line. The <code>geom_smooth</code> function will allow me to do this, although I will have to specify the method:</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb863-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty, <span class="dt">y=</span>amtcapita))<span class="op">+</span></a>
<a class="sourceLine" id="cb863-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>, <span class="kw">aes</span>(<span class="dt">color=</span>borough, <span class="dt">size=</span>popn))<span class="op">+</span></a>
<a class="sourceLine" id="cb863-3" title="3"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb863-4" title="4"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels=</span>dollar)<span class="op">+</span></a>
<a class="sourceLine" id="cb863-5" title="5"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Dark2&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb863-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="stat_book_files/figure-html/ggplot_smooth-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I made a couple of important changes here that are quite subtle but important. First, I moves the aesthetics for color and size out of the <code>ggplot</code> command and put them into the <code>geom_point</code>. This is because I don’t want those aesthetics to apply to all geoms. I only want them to apply to <code>geom_point</code>. If I had left them in they would have affected the <code>geom_smooth</code> and we would have had five separate lines for each borough.</p>
<p>I also added <code>color="black"</code> to the <code>geom_smooth</code> command. Note that this is not part of an aesthetic call (e.g. <code>aes()</code>). It is not considered an aesthetic because we are just asking for the line to be a single color. Try surrounding that command in an <code>aes</code> and see what happens.</p>
<p>I also used the <code>se=FALSE</code>. If I don’t do this then the line above will be surrounded by a confidence band, which may be good or bad. For our purposes, I did not want to clutter the graph.</p>
<p>We are now pretty close to being complete, but I still need to label all of my axes and provide a title. I also want better labeling for the two legends. This can all be done with the <code>labs</code> command which we append to the entire plot:</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb864-1" title="1"><span class="kw">rm</span>(percent)</a></code></pre></div>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb865-1" title="1"><span class="kw">ggplot</span>(nyc, <span class="kw">aes</span>(<span class="dt">x=</span>poverty<span class="op">/</span><span class="dv">100</span>, <span class="dt">y=</span>amtcapita))<span class="op">+</span></a>
<a class="sourceLine" id="cb865-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>, <span class="kw">aes</span>(<span class="dt">color=</span>borough, <span class="dt">size=</span>popn))<span class="op">+</span></a>
<a class="sourceLine" id="cb865-3" title="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">label=</span>percent)<span class="op">+</span></a>
<a class="sourceLine" id="cb865-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb865-5" title="5"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">labels=</span>dollar)<span class="op">+</span></a>
<a class="sourceLine" id="cb865-6" title="6"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Dark2&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb865-7" title="7"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb865-8" title="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb865-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb865-10" title="10">       <span class="dt">y=</span><span class="st">&quot;amount per capita&quot;</span>,</a>
<a class="sourceLine" id="cb865-11" title="11">       <span class="dt">title=</span><span class="st">&quot;Non-profit funding to NYC health area by poverty rate&quot;</span>,</a>
<a class="sourceLine" id="cb865-12" title="12">       <span class="dt">caption=</span><span class="st">&quot;Data from NYC, 2009-2010&quot;</span>,</a>
<a class="sourceLine" id="cb865-13" title="13">       <span class="dt">color=</span><span class="st">&quot;Borough&quot;</span>,</a>
<a class="sourceLine" id="cb865-14" title="14">       <span class="dt">size=</span><span class="st">&quot;Population&quot;</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/unnamed-chunk-244-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I did a couple of other things here as well. I added a <code>scale_x_continuous</code> so I could label the x tick mark labels as percents. I also added another <code>theme</code> command that would allow me to change the placement of the legends. I want to keep it on the right, but could have chosen “left”, “right”, “top”, or “bottom.”</p>
<p>We now have a very nice looking graph. Ggplot can be a little overwhelming at first, but it has quite a few advantages over base plot. It is designed so that we have to fidget around less with things like the size of our labels, the exact placement of our legends, and the margins of our table. All of that just works internally, and we can focus on the “grammar of graphics”, i.e. the logic structure of what we are trying to say with our graph.</p>
<p>Lets do one more example to show how flexible ggplot is. Lets look at the distribution of popularity by race in the Add Health data. Because we have one categorical and one quantitative variable, we want comparative boxplots. Here is our basic set up:</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb866-1" title="1"><span class="kw">ggplot</span>(addhealth, <span class="kw">aes</span>(<span class="dt">x=</span>race, <span class="dt">y=</span>indegree))<span class="op">+</span></a>
<a class="sourceLine" id="cb866-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb866-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="stat_book_files/figure-html/unnamed-chunk-245-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>That works pretty well, However, its often better to display these boxplots horizontally so that we don’t have to worry about category labels overlapping. We can do that with ggplot with the <code>coord_flip</code> command (an example of a coordinate layer):</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb867-1" title="1"><span class="kw">ggplot</span>(addhealth, <span class="kw">aes</span>(<span class="dt">x=</span>race, <span class="dt">y=</span>indegree))<span class="op">+</span></a>
<a class="sourceLine" id="cb867-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb867-3" title="3"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb867-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="stat_book_files/figure-html/unnamed-chunk-246-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is already pretty good. Notice that I don’t have to worry about specifying margins to make sure my category labels fit. Ggplot does that for me. I just need to apply labels and maybe a bit of tint to my boxplots.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb868-1" title="1"><span class="kw">ggplot</span>(addhealth, <span class="kw">aes</span>(<span class="dt">x=</span>race, <span class="dt">y=</span>indegree))<span class="op">+</span></a>
<a class="sourceLine" id="cb868-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&quot;grey70&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb868-3" title="3"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb868-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb868-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb868-6" title="6">       <span class="dt">y=</span><span class="st">&quot;Number of friend nominations received&quot;</span>,</a>
<a class="sourceLine" id="cb868-7" title="7">       <span class="dt">title=</span><span class="st">&quot;Comparative boxplots of friend nominations by race&quot;</span>,</a>
<a class="sourceLine" id="cb868-8" title="8">       <span class="dt">caption=</span><span class="st">&quot;Add Health data, Wave 1&quot;</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/unnamed-chunk-247-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that the labels for x and y refer to the logic decision of which value is x and y as defined in the aesthetics not the actual placement, which was reversed due to the <code>coord_flip</code>. Note also that I used <code>NULL</code> for the x label because the category labels and title are self-explanatory.</p>
<p>There are also some more advanced geoms that do something similar to a boxplot. A popular one is the <code>geom_violin</code> which plots a mirror image of the density distribution. With ggplot, its as simple as swapping out my boxplot with the violin:</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb869-1" title="1"><span class="kw">ggplot</span>(addhealth, <span class="kw">aes</span>(<span class="dt">x=</span>race, <span class="dt">y=</span>indegree))<span class="op">+</span></a>
<a class="sourceLine" id="cb869-2" title="2"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">fill=</span><span class="st">&quot;grey70&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb869-3" title="3"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb869-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb869-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb869-6" title="6">       <span class="dt">y=</span><span class="st">&quot;Number of friend nominations received&quot;</span>,</a>
<a class="sourceLine" id="cb869-7" title="7">       <span class="dt">title=</span><span class="st">&quot;Comparative boxplots of friend nominations by race&quot;</span>,</a>
<a class="sourceLine" id="cb869-8" title="8">       <span class="dt">caption=</span><span class="st">&quot;Add Health data, Wave 1&quot;</span>)</a></code></pre></div>
<p><img src="stat_book_files/figure-html/unnamed-chunk-248-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I encourage you to explore the online <a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot documentation</a>. I would also highly recommend Kieran Healy’s new book, <a href="https://kieranhealy.org/publications/dataviz/"><em>Data Visualization</em></a> which uses ggplot extensively if you want to learn more about using ggplot most effectively.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="object-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-git.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
